language: cpp

services:
- docker

compiler:
- gcc

env:
- COMPILER=gcc_510
- COMPILER=gcc_520
- COMPILER=gcc_530
- COMPILER=gcc_540
- COMPILER=gcc_610

before_install:
- pip install --user git+git://github.com/eddyxu/cpp-coveralls.git

install:
- if [[ -n $(./tools/astyle/linux/run.sh | grep Formatted) ]]; then echo "You must run astyle before submitting a pull request"; exit -1; fi
- travis_wait 40 ./tools/scripts/setup_ubuntu.sh -g $COMPILER

script:
- TRAVISCI=yes make -j2
- make unittest

after_success:
- coveralls --build-root makefiles -e build_libbfc -e build_libcxx -e build_libcxxabi -e build_newlib -e build_scripts -e common -e doc -e extensions -e source_libbfc -e source_libcxx -e source_libcxxabi -e source_llvm -e source_newlib -e sysroot -e tools -e bfc -e bfcxx -e bfdrivers/src/arch -e bfm/src/arch -e include/hippomocks.h -e include/unittest.h -e bfunwind -e bfvmm/src/vcpu_factory/src/vcpu_factory.cpp -e bfvmm/include/intrinsics/intrinsics_x64.h -e bfvmm/include/intrinsics/intrinsics_intel_x64.h -e include/gsl -e include/exception.h -e bfvmm/src/vmcs -e bfvmm/include/vmcs --gcov-options '\-lp'
